<script type="text/javascript">
        var gk_isXlsx = false;
        var gk_xlsxFileLookup = {};
        var gk_fileData = {};
        function filledCell(cell) {
          return cell !== '' && cell != null;
        }
        function loadFileData(filename) {
        if (gk_isXlsx && gk_xlsxFileLookup[filename]) {
            try {
                var workbook = XLSX.read(gk_fileData[filename], { type: 'base64' });
                var firstSheetName = workbook.SheetNames[0];
                var worksheet = workbook.Sheets[firstSheetName];

                // Convert sheet to JSON to filter blank rows
                var jsonData = XLSX.utils.sheet_to_json(worksheet, { header: 1, blankrows: false, defval: '' });
                // Filter out blank rows (rows where all cells are empty, null, or undefined)
                var filteredData = jsonData.filter(row => row.some(filledCell));

                // Heuristic to find the header row by ignoring rows with fewer filled cells than the next row
                var headerRowIndex = filteredData.findIndex((row, index) =>
                  row.filter(filledCell).length >= filteredData[index + 1]?.filter(filledCell).length
                );
                // Fallback
                if (headerRowIndex === -1 || headerRowIndex > 25) {
                  headerRowIndex = 0;
                }

                // Convert filtered JSON back to CSV
                var csv = XLSX.utils.aoa_to_sheet(filteredData.slice(headerRowIndex)); // Create a new sheet from filtered array of arrays
                csv = XLSX.utils.sheet_to_csv(csv, { header: 1 });
                return csv;
            } catch (e) {
                console.error(e);
                return "";
            }
        }
        return gk_fileData[filename] || "";
        }
        </script><!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <link rel="icon" type="image/svg+xml" href="/vite.svg">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Ù…Ø³Ø¨Ø­Ø© Ø§Ù„Ù…Ø§ÙƒÙ† Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ©</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@300;400;500;700&display=swap" rel="stylesheet">
  <script src="https://unpkg.com/react@18.2.0/umd/react.production.min.js" onerror='console.error("Failed to load React")'></script>
  <script src="https://unpkg.com/react-dom@18.2.0/umd/react-dom.production.min.js" onerror='console.error("Failed to load ReactDOM")'></script>
  <script src="https://cdn.tailwindcss.com/3.4.1"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            primary: "#9333EA",
            secondary: "#4C1D95",
            dark: {
              100: "#1a1a1a",
              200: "#2d2d2d",
              300: "#404040",
              400: "#525252",
              500: "#737373",
              600: "#a3a3a3",
              700: "#d4d4d4",
              800: "#f5f5f5",
              900: "#ffffff"
            }
          }
        }
      }
    }
  </script>
  <style>
    body {
      font-family: Tajawal, sans-serif;
      direction: rtl;
      background-color: #000;
      color: #fff;
    }
    @keyframes ripple {
      0% { transform: scale(0); opacity: .5; }
      100% { transform: scale(1.5); opacity: 0; }
    }
    .ripple-effect {
      position: absolute;
      width: 100%;
      height: 100%;
      background: radial-gradient(circle, rgba(147,51,234,.4) 10%, transparent 10.01%);
      border-radius: 50%;
      animation: ripple .5s ease-out;
      pointer-events: none;
    }
    .circle-button {
      transition: transform .1s ease, box-shadow .1s ease;
    }
    .circle-button:active {
      transform: scale(.85);
      box-shadow: 0 2px 4px rgba(0,0,0,.3);
    }
    .progress-circle {
      position: absolute;
      width: 100%;
      height: 100%;
      transform: rotate(-90deg);
    }
    .progress-circle-bg {
      fill: none;
      stroke: #ffffff; /* ØªØºÙŠÙŠØ± Ø§Ù„Ù„ÙˆÙ† Ø¥Ù„Ù‰ Ø§Ù„Ø£Ø¨ÙŠØ¶ */
      stroke-width: 8;
    }
    .progress-circle-fill {
      fill: none;
      stroke: #9333EA;
      stroke-width: 8;
      stroke-linecap: round;
      transition: stroke-dashoffset .3s ease;
    }
    .card {
      background-color: #1a1a1a;
      border: 1px solid #2d2d2d;
    }
    .progress-bar {
      background-color: #2d2d2d;
    }
    .progress-fill {
      background-color: #9333ea;
    }
    .modal-overlay {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0,0,0,.7);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 50;
    }
    .modal-content {
      background: #1a1a1a;
      padding: 20px;
      border-radius: 8px;
      border: 1px solid #2d2d2d;
      width: 90%;
      max-width: 400px;
      text-align: center;
    }
  </style>
</head>
<body>
  <div id="root"></div>
  <script type="text/javascript">
        var gk_isXlsx = false;
        var gk_xlsxFileLookup = {};
        var gk_fileData = {};
        function filledCell(cell) {
          return cell !== '' && cell != null;
        }
        function loadFileData(filename) {
        if (gk_isXlsx && gk_xlsxFileLookup[filename]) {
            try {
                var workbook = XLSX.read(gk_fileData[filename], { type: 'base64' });
                var firstSheetName = workbook.SheetNames[0];
                var worksheet = workbook.Sheets[firstSheetName];

                // Convert sheet to JSON to filter blank rows
                var jsonData = XLSX.utils.sheet_to_json(worksheet, { header: 1, blankrows: false, defval: '' });
                // Filter out blank rows (rows where all cells are empty, null, or undefined)
                var filteredData = jsonData.filter(row => row.some(filledCell));

                // Heuristic to find the header row by ignoring rows with fewer filled cells than the next row
                var headerRowIndex = filteredData.findIndex((row, index) =>
                  row.filter(filledCell).length >= filteredData[index + 1]?.filter(filledCell).length
                );
                // Fallback
                if (headerRowIndex === -1 || headerRowIndex > 25) {
                  headerRowIndex = 0;
                }

                // Convert filtered JSON back to CSV
                var csv = XLSX.utils.aoa_to_sheet(filteredData.slice(headerRowIndex)); // Create a new sheet from filtered array of arrays
                csv = XLSX.utils.sheet_to_csv(csv, { header: 1 });
                return csv;
            } catch (e) {
                console.error(e);
                return "";
            }
        }
        return gk_fileData[filename] || "";
        }
  </script>
  <script type="text/babel">
    function Modal({ isOpen, onClose, onSubmit, title, defaultValue = '', type = 'text', isConfirm = false }) {
      const [inputValue, setInputValue] = React.useState(defaultValue);

      React.useEffect(() => {
        setInputValue(defaultValue);
        console.log('Modal: defaultValue updated to:', defaultValue);
      }, [defaultValue]);

      if (!isOpen) {
        console.log('Modal: Not open, returning null');
        return null;
      }

      const handleConfirm = () => {
        console.log('Modal: handleConfirm called with value:', inputValue, 'isConfirm:', isConfirm);
        try {
          if (!onSubmit) {
            console.error('Modal: onSubmit is not defined');
            alert('Ø®Ø·Ø£: Ø¯Ø§Ù„Ø© Ø§Ù„ØªØ£ÙƒÙŠØ¯ ØºÙŠØ± Ù…Ø¹Ø±ÙØ©');
            onClose();
            return;
          }
          onSubmit(isConfirm ? true : inputValue);
          console.log('Modal: onSubmit executed successfully');
          onClose();
        } catch (error) {
          console.error('Modal: Error in handleConfirm:', error);
          alert('Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ ØªÙ†ÙÙŠØ° Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡: ' + error.message);
          onClose();
        }
      };

      return (
        <div 
          className="modal-overlay" 
          onClick={isConfirm ? onClose : undefined}
        >
          <div 
            className="modal-content" 
            onClick={(e) => e.stopPropagation()}
          >
            <h2 className="text-lg font-medium text-primary mb-4">{title}</h2>
            {!isConfirm && (
              <input
                type={type}
                value={inputValue}
                onChange={(e) => {
                  setInputValue(e.target.value);
                  console.log('Modal: Input changed to:', e.target.value);
                }}
                className="w-full py-2 px-4 bg-dark-100 border border-dark-200 rounded-lg text-white mb-4"
                placeholder="Ø£Ø¯Ø®Ù„ Ø§Ù„Ù‚ÙŠÙ…Ø©..."
              />
            )}
            {isConfirm && (
              <div className="text-white mb-4">
                {type === 'about' ? (
                  <>
                    <p>Ù…Ø³Ø¨Ø­Ø© Ø§Ù„Ù…Ø§ÙƒÙ† Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ© - Ø§Ù„Ø¥ØµØ¯Ø§Ø± 1.0.0</p>
                    <p>ØªØ·Ø¨ÙŠÙ‚ ÙŠØ³Ø§Ø¹Ø¯Ùƒ Ø¹Ù„Ù‰ ØªØ³Ø¨ÙŠØ­ Ø§Ù„Ù„Ù‡ ÙˆØ°ÙƒØ±Ù‡ ÙÙŠ Ø£ÙŠ ÙˆÙ‚Øª ÙˆÙ…ÙƒØ§Ù†.</p>
                    <p className="mt-2">Ø§Ù„Ù…Ù…ÙŠØ²Ø§Øª Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©:</p>
                    <ul className="list-disc mr-4 text-right">
                      <li>Ø¹Ø¯Ø§Ø¯ ØªØ³Ø¨ÙŠØ­ Ø³Ù‡Ù„ Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…</li>
                      <li>Ø¥Ù…ÙƒØ§Ù†ÙŠØ© Ø¥Ø¶Ø§ÙØ© ÙˆØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø£Ø°ÙƒØ§Ø± Ø§Ù„Ù…Ø®ØµØµØ©</li>
                      <li>Ù…ØªØ§Ø¨Ø¹Ø© Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„ÙŠÙˆÙ…ÙŠØ© ÙˆØ§Ù„Ø´Ù‡Ø±ÙŠØ©</li>
                      <li>Ø¥Ù…ÙƒØ§Ù†ÙŠØ© Ø¶Ø¨Ø· Ø§Ù„Ø£Ù‡Ø¯Ø§Ù Ø§Ù„ÙŠÙˆÙ…ÙŠØ© ÙˆØ§Ù„Ø´Ù‡Ø±ÙŠØ©</li>
                    </ul>
                  </>
                ) : (
                  <p>{title}</p>
                )}
              </div>
            )}
            <div className="flex justify-center">
              {type !== 'about' && isConfirm && (
                <button
                  type="button"
                  onClick={handleConfirm}
                  className="bg-primary text-white px-4 py-2 rounded-lg mx-2"
                >
                  ØªØ£ÙƒÙŠØ¯
                </button>
              )}
              {!isConfirm && (
                <button
                  type="button"
                  onClick={handleConfirm}
                  className="bg-primary text-white px-4 py-2 rounded-lg mx-2"
                >
                  ØªØ£ÙƒÙŠØ¯
                </button>
              )}
              <button
                type="button"
                onClick={() => {
                  console.log('Modal: Cancel button clicked');
                  onClose();
                }}
                className="bg-dark-200 text-white px-4 py-2 rounded-lg mx-2"
              >
                Ø¥Ù„ØºØ§Ø¡
              </button>
            </div>
          </div>
        </div>
      );
    }

    function App() {
      console.log('App: Component rendered');
      const [state, setState] = React.useState({
        count: 0,
        dailyCount: 0,
        currentZikr: 'Ø³Ø¨Ø­Ø§Ù† Ø§Ù„Ù„Ù‡',
        azkar: [
          { id: '1', text: 'Ø³Ø¨Ø­Ø§Ù† Ø§Ù„Ù„Ù‡', dailyCount: 0, totalCount: 0, circleGoal: 33 },
          { id: '2', text: 'Ø§Ù„Ø­Ù…Ø¯ Ù„Ù„Ù‡', dailyCount: 0, totalCount: 0, circleGoal: 33 },
          { id: '3', text: 'Ø§Ù„Ù„Ù‡ Ø£ÙƒØ¨Ø±', dailyCount: 0, totalCount: 0, circleGoal: 33 },
          { id: '4', text: 'Ù„Ø§ Ø¥Ù„Ù‡ Ø¥Ù„Ø§ Ø§Ù„Ù„Ù‡', dailyCount: 0, totalCount: 0, circleGoal: 33 },
          { id: '5', text: 'Ø£Ø³ØªØºÙØ± Ø§Ù„Ù„Ù‡', dailyCount: 0, totalCount: 0, circleGoal: 33 }
        ],
        settings: {
          sound: true,
          vibration: true
        },
        stats: {
          daily: 0,
          monthly: 0,
          total: 0,
          goals: {
            daily: 100,
            monthly: 8000
          },
          lastZikr: {
            text: '',
            count: 0
          }
        }
      });

      const [activeTab, setActiveTab] = React.useState('tasbih');
      const [searchTerm, setSearchTerm] = React.useState('');
      const [modal, setModal] = React.useState({ isOpen: false, type: '', data: {}, isConfirm: false });
      const [sound] = React.useState(new Audio('https://soundbible.com/mp3/Click2-Sebastian-759472264.mp3'));
      const [isPressed, setIsPressed] = React.useState(false);

      React.useEffect(() => {
        console.log('App: Loading state from localStorage');
        try {
          const savedState = localStorage.getItem('tasbihState');
          const lastResetDate = localStorage.getItem('lastResetDate');
          const today = new Date().toISOString().split('T')[0];

          if (savedState) {
            let parsedState = JSON.parse(savedState);
            
            if (lastResetDate !== today) {
              console.log('App: New day detected, resetting daily counters');
              parsedState = {
                ...parsedState,
                dailyCount: 0,
                azkar: parsedState.azkar.map(z => ({ ...z, dailyCount: 0 })),
                stats: {
                  ...parsedState.stats,
                  daily: 0
                }
              };
              localStorage.setItem('lastResetDate', today);
              localStorage.setItem('tasbihState', JSON.stringify(parsedState));
              console.log('App: Daily counters reset and saved to localStorage');
            }
            
            setState(parsedState);
            console.log('App: State loaded from localStorage:', parsedState);
          } else {
            localStorage.setItem('lastResetDate', today);
          }
        } catch (error) {
          console.error('App: Error parsing saved state or resetting counters:', error);
        }
      }, []);

      React.useEffect(() => {
        try {
          localStorage.setItem('tasbihState', JSON.stringify(state));
          console.log('App: State saved to localStorage:', state);
        } catch (error) {
          console.error('App: Error saving state to localStorage:', error);
        }
      }, [state]);

      const incrementCounter = (e) => {
        e.stopPropagation();
        console.log('App: incrementCounter triggered');
        try {
          const zikr = state.azkar.find(z => z.text === state.currentZikr);
          if (!zikr) {
            console.error('App: Current zikr not found:', state.currentZikr);
            return;
          }

          setState(prevState => {
            const newCount = prevState.count + 1;
            const newDailyCount = prevState.dailyCount + 1;
            const newDaily = prevState.stats.daily + 1;
            const newMonthly = prevState.stats.monthly + 1;
            const newTotal = prevState.stats.total + 1;
            
            const resetCount = newCount >= zikr.circleGoal ? 0 : newCount;
            
            const updatedAzkar = prevState.azkar.map(z => 
              z.text === state.currentZikr 
                ? { ...z, dailyCount: z.dailyCount + 1, totalCount: z.totalCount + 1 } 
                : z
            );
            
            if (prevState.settings.sound) {
              const clonedSound = sound.cloneNode();
              clonedSound.play().catch(err => {
                console.error('App: Error playing sound:', err);
              });
            }
            
            if (prevState.settings.vibration && 'vibrate' in navigator) {
              navigator.vibrate(50);
            }
            
            return {
              ...prevState,
              count: resetCount,
              dailyCount: newDailyCount,
              stats: {
                ...prevState.stats,
                daily: newDaily,
                monthly: newMonthly,
                total: newTotal,
                lastZikr: {
                  text: state.currentZikr,
                  count: prevState.stats.lastZikr.text === state.currentZikr ? 
                    prevState.stats.lastZikr.count + 1 : 1
                }
              },
              azkar: updatedAzkar
            };
          });
        } catch (error) {
          console.error('App: Error in incrementCounter:', error);
        }
      };

      const handleMouseDown = () => {
        setIsPressed(true);
      };

      const handleMouseUp = () => {
        setIsPressed(false);
      };

      const resetCounter = (e) => {
        e.stopPropagation();
        console.log('App: resetCounter triggered');
        try {
          setState(prevState => ({
            ...prevState,
            count: 0
          }));
        } catch (error) {
          console.error('App: Error in resetCounter:', error);
        }
      };

      const openModal = (type, data = {}, isConfirm = false) => {
        console.log('App: openModal called with type:', type, 'data:', data, 'isConfirm:', isConfirm);
        try {
          setModal({ isOpen: true, type, data, isConfirm });
          console.log('App: Modal state updated:', { isOpen: true, type, data, isConfirm });
        } catch (error) {
          console.error('App: Error in openModal:', error);
          alert('Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ ÙØªØ­ Ø§Ù„Ù†Ø§ÙØ°Ø©: ' + error.message);
        }
      };

      const closeModal = () => {
        console.log('App: closeModal called');
        try {
          setModal({ isOpen: false, type: '', data: {}, isConfirm: false });
          console.log('App: Modal closed');
        } catch (error) {
          console.error('App: Error in closeModal:', error);
        }
      };

      const editCurrentZikrGoal = (e) => {
        e.stopPropagation();
        console.log('App: editCurrentZikrGoal triggered');
        try {
          const zikr = state.azkar.find(z => z.text === state.currentZikr);
          if (!zikr) {
            console.error('App: Current zikr not found:', state.currentZikr);
            alert('Ø®Ø·Ø£: Ø§Ù„Ø°ÙƒØ± Ø§Ù„Ø­Ø§Ù„ÙŠ ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯');
            return;
          }
          openModal('editZikrGoal', { zikr, defaultValue: zikr.circleGoal.toString() });
        } catch (error) {
          console.error('App: Error in editCurrentZikrGoal:', error);
        }
      };

      const handleEditZikrGoal = (value) => {
        console.log('App: handleEditZikrGoal called with value:', value);
        try {
          const goalValue = parseInt(value);
          if (isNaN(goalValue) || goalValue <= 0) {
            console.warn('App: Invalid goal value:', value);
            alert('ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø±Ù‚Ù… ØµØ­ÙŠØ­ Ø¥ÙŠØ¬Ø§Ø¨ÙŠ');
            return;
          }
          const zikr = modal.data.zikr;
          if (!zikr) {
            console.error('App: Zikr not found in modal data');
            alert('Ø®Ø·Ø£: Ø§Ù„Ø°ÙƒØ± ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯');
            return;
          }
          setState(prevState => ({
            ...prevState,
            count: 0,
            azkar: prevState.azkar.map(z => 
              z.id === zikr.id ? { ...z, circleGoal: goalValue } : z
            )
          }));
          console.log('App: Zikr goal updated successfully');
        } catch (error) {
          console.error('App: Error in handleEditZikrGoal:', error);
          alert('Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ù‡Ø¯Ù: ' + error.message);
        }
      };

      const switchToZikr = (zikrText) => {
        console.log('App: switchToZikr triggered:', zikrText);
        try {
          setState(prevState => ({
            ...prevState,
            currentZikr: zikrText,
            count: 0
          }));
          setActiveTab('tasbih');
        } catch (error) {
          console.error('App: Error in switchToZikr:', error);
        }
      };

      const addZikr = (e) => {
        e.stopPropagation();
        console.log('App: addZikr triggered');
        try {
          openModal('addZikr', { defaultValue: '' });
        } catch (error) {
          console.error('App: Error in addZikr:', error);
        }
      };

      const handleAddZikr = (text) => {
        console.log('App: handleAddZikr called with text:', text);
        try {
          if (!text || !text.trim()) {
            console.warn('App: Empty zikr text');
            alert('ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ù†Øµ Ø§Ù„Ø°ÙƒØ±');
            return;
          }
          const trimmedText = text.trim();
          if (state.azkar.some(z => z.text === trimmedText)) {
            console.warn('App: Duplicate zikr:', trimmedText);
            alert('Ø§Ù„Ø°ÙƒØ± Ù…ÙˆØ¬ÙˆØ¯ Ø¨Ø§Ù„ÙØ¹Ù„');
            return;
          }
          const newZikr = {
            id: Date.now().toString(),
            text: trimmedText,
            dailyCount: 0,
            totalCount: 0,
            circleGoal: 33
          };
          setState(prevState => ({
            ...prevState,
            azkar: [...prevState.azkar, newZikr]
          }));
          console.log('App: Zikr added successfully');
        } catch (error) {
          console.error('App: Error in handleAddZikr:', error);
          alert('Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø°ÙƒØ±: ' + error.message);
        }
      };

      const editZikr = (id, e) => {
        e.stopPropagation();
        console.log('App: editZikr triggered:', id);
        try {
          const zikr = state.azkar.find(z => z.id === id);
          if (!zikr) {
            console.error('App: Zikr not found:', id);
            alert('Ø®Ø·Ø£: Ø§Ù„Ø°ÙƒØ± ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯');
            return;
          }
          openModal('editZikr', { zikr, defaultValue: zikr.text });
        } catch (error) {
          console.error('App: Error in editZikr:', error);
        }
      };

      const handleEditZikr = (text) => {
        console.log('App: handleEditZikr called with text:', text);
        try {
          if (!text || !text.trim()) {
            console.warn('App: Empty zikr text');
            alert('ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ù†Øµ Ø§Ù„Ø°ÙƒØ±');
            return;
          }
          const trimmedText = text.trim();
          const zikr = modal.data.zikr;
          if (!zikr) {
            console.error('App: Zikr not found in modal data');
            alert('Ø®Ø·Ø£: Ø§Ù„Ø°ÙƒØ± ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯');
            return;
          }
          if (state.azkar.some(z => z.text === trimmedText && z.id !== zikr.id)) {
            console.warn('App: Duplicate zikr:', trimmedText);
            alert('Ø§Ù„Ø°ÙƒØ± Ù…ÙˆØ¬ÙˆØ¯ Ø¨Ø§Ù„ÙØ¹Ù„');
            return;
          }
          setState(prevState => ({
            ...prevState,
            azkar: prevState.azkar.map(z => 
              z.id === zikr.id ? { ...z, text: trimmedText } : z
            ),
            currentZikr: zikr.text === prevState.currentZikr ? trimmedText : prevState.currentZikr
          }));
          console.log('App: Zikr edited successfully');
        } catch (error) {
          console.error('App: Error in handleEditZikr:', error);
          alert('Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø°ÙƒØ±: ' + error.message);
        }
      };

      const deleteZikr = (id, e) => {
        e.stopPropagation();
        console.log('App: deleteZikr triggered with id:', id);
        try {
          const zikr = state.azkar.find(z => z.id === id);
          if (!zikr) {
            console.error('App: Zikr not found for id:', id);
            alert('Ø®Ø·Ø£: Ø§Ù„Ø°ÙƒØ± ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯');
            return;
          }
          openModal('deleteZikr', { zikr }, true);
          console.log('App: Modal opened for deleteZikr');
        } catch (error) {
          console.error('App: Error in deleteZikr:', error);
          alert('Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ù…Ø­Ø§ÙˆÙ„Ø© Ø­Ø°Ù Ø§Ù„Ø°ÙƒØ±: ' + error.message);
        }
      };

      const handleDeleteZikr = () => {
        console.log('App: handleDeleteZikr called for zikr:', modal.data.zikr?.text);
        try {
          const zikr = modal.data.zikr;
          if (!zikr) {
            console.error('App: Zikr not found in modal data');
            alert('Ø®Ø·Ø£: Ø§Ù„Ø°ÙƒØ± ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯');
            return;
          }
          setState(prevState => {
            let newCurrentZikr = prevState.currentZikr;
            if (zikr.text === prevState.currentZikr) {
              const remainingAzkar = prevState.azkar.filter(z => z.id !== zikr.id);
              newCurrentZikr = remainingAzkar.length > 0 ? remainingAzkar[0].text : '';
            }
            return {
              ...prevState,
              azkar: prevState.azkar.filter(z => z.id !== zikr.id),
              currentZikr: newCurrentZikr,
              count: 0
            };
          });
          console.log('App: Zikr deleted successfully');
        } catch (error) {
          console.error('App: Error in handleDeleteZikr:', error);
          alert('Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø­Ø°Ù Ø§Ù„Ø°ÙƒØ±: ' + error.message);
        }
      };

      const editGoal = (type, e) => {
        e.stopPropagation();
        console.log('App: editGoal triggered:', type);
        try {
          const currentGoal = state.stats.goals[type];
          openModal('editGoal', { type, defaultValue: currentGoal.toString() });
        } catch (error) {
          console.error('App: Error in editGoal:', error);
        }
      };

      const handleEditGoal = (value) => {
        console.log('App: handleEditGoal called with value:', value);
        try {
          const goalValue = parseInt(value);
          if (isNaN(goalValue) || goalValue <= 0) {
            console.warn('App: Invalid goal value:', value);
            alert('ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø±Ù‚Ù… ØµØ­ÙŠØ­ Ø¥ÙŠØ¬Ø§Ø¨ÙŠ');
            return;
          }
          setState(prevState => ({
            ...prevState,
            stats: {
              ...prevState.stats,
              goals: {
                ...prevState.stats.goals,
                [modal.data.type]: goalValue
              }
            }
          }));
          console.log('App: Goal updated successfully');
        } catch (error) {
          console.error('App: Error in handleEditGoal:', error);
          alert('Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ù‡Ø¯Ù: ' + error.message);
        }
      };

      const updateSetting = (setting, value) => {
        console.log('App: updateSetting triggered:', setting, value);
        try {
          setState(prevState => ({
            ...prevState,
            settings: {
              ...prevState.settings,
              [setting]: value
            }
          }));
        } catch (error) {
          console.error('App: Error in updateSetting:', error);
        }
      };

      const showAbout = (e) => {
        e.stopPropagation();
        console.log('App: showAbout triggered');
        try {
          openModal('about', {}, true);
          console.log('App: Modal opened for about');
        } catch (error) {
          console.error('App: Error in showAbout:', error);
          alert('Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ ÙØªØ­ Ù†Ø§ÙØ°Ø© Ø¹Ù† Ø§Ù„ØªØ·Ø¨ÙŠÙ‚: ' + error.message);
        }
      };

      const filteredAzkar = state.azkar.filter(zikr => 
        zikr.text.toLowerCase().includes(searchTerm.toLowerCase())
      );

      const dailyProgress = Math.min((state.dailyCount / state.stats.goals.daily) * 100, 100);
      const statsDaily = Math.min((state.stats.daily / state.stats.goals.daily) * 100, 100);
      const statsMonthly = Math.min((state.stats.monthly / state.stats.goals.monthly) * 100, 100);

      const formatDate = () => {
        try {
          return new Intl.DateTimeFormat('ar-SA', {
            weekday: 'long',
            year: 'numeric',
            month: 'long',
            day: 'numeric'
          }).format(new Date());
        } catch (error) {
          console.error('App: Error in formatDate:', error);
          return '';
        }
      };

      const currentZikr = state.azkar.find(z => z.text === state.currentZikr);
      const circleProgress = currentZikr ? Math.min((state.count / currentZikr.circleGoal) * 100, 100) : 0;
      const circumference = 2 * Math.PI * 120;
      const offset = circumference - (circleProgress / 100) * circumference;

      return (
        <div className="min-h-screen bg-black text-white mx-auto max-w-md">
          <Modal
            isOpen={modal.isOpen && modal.type === 'editZikrGoal'}
            onClose={closeModal}
            onSubmit={handleEditZikrGoal}
            title={`ØªØ¹Ø¯ÙŠÙ„ Ù‡Ø¯Ù Ø§Ù„Ø¯Ø§Ø¦Ø±Ø© Ù„Ù€ "${modal.data.zikr?.text || ''}"`}
            defaultValue={modal.data.defaultValue || ''}
            type="number"
          />
          <Modal
            isOpen={modal.isOpen && modal.type === 'addZikr'}
            onClose={closeModal}
            onSubmit={handleAddZikr}
            title="Ø¥Ø¶Ø§ÙØ© Ø°ÙƒØ± Ø¬Ø¯ÙŠØ¯"
            defaultValue={modal.data.defaultValue || ''}
          />
          <Modal
            isOpen={modal.isOpen && modal.type === 'editZikr'}
            onClose={closeModal}
            onSubmit={handleEditZikr}
            title="ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø°ÙƒØ±"
            defaultValue={modal.data.defaultValue || ''}
          />
          <Modal
            isOpen={modal.isOpen && modal.type === 'deleteZikr'}
            onClose={closeModal}
            onSubmit={handleDeleteZikr}
            title={`Ù‡Ù„ ØªØ±ÙŠØ¯ Ø­Ø°Ù "${modal.data.zikr?.text || ''}"ØŸ`}
            isConfirm={true}
          />
          <Modal
            isOpen={modal.isOpen && modal.type === 'editGoal'}
            onClose={closeModal}
            onSubmit={handleEditGoal}
            title={modal.data.type === 'daily' ? 'ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ù‡Ø¯Ù Ø§Ù„ÙŠÙˆÙ…ÙŠ' : 'ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ù‡Ø¯Ù Ø§Ù„Ø´Ù‡Ø±ÙŠ'}
            defaultValue={modal.data.defaultValue || ''}
            type="number"
          />
          <Modal
            isOpen={modal.isOpen && modal.type === 'about'}
            onClose={closeModal}
            title="Ø¹Ù† Ø§Ù„ØªØ·Ø¨ÙŠÙ‚"
            type="about"
            isConfirm={true}
          />

          <div className="fixed top-0 w-full bg-dark-100 border-b border-dark-200 z-10 max-w-md">
            <div className="flex items-center justify-center h-14 px-4">
              <h1 className="text-xl font-bold text-primary">Ù…Ø³Ø¨Ø­Ø© Ø§Ù„Ù…Ø§ÙƒÙ† Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ©</h1>
            </div>
          </div>

          <div className="pt-16 pb-16">
            {activeTab === 'tasbih' && (
              <div className="px-4 py-6">
                <div className="flex flex-col items-center justify-center mt-8">
                  <h2 className="text-xl font-medium text-white mb-4">{state.currentZikr}</h2>
                  
                  <div className="relative w-72 h-72 flex items-center justify-center">
                    <svg className="progress-circle" width="272" height="272" viewBox="0 0 272 272">
                      <circle
                        className="progress-circle-bg"
                        cx="136"
                        cy="136"
                        r="120"
                      />
                      <circle
                        className="progress-circle-fill"
                        cx="136"
                        cy="136"
                        r="120"
                        strokeDasharray={circumference}
                        strokeDashoffset={offset}
                      />
                    </svg>
                    <div 
                      onClick={incrementCounter}
                      onMouseDown={handleMouseDown}
                      onMouseUp={handleMouseUp}
                      onTouchStart={handleMouseDown}
                      onTouchEnd={handleMouseUp}
                      className={`circle-button bg-dark-100 border border-dark-200 shadow-lg rounded-full w-64 h-64 flex items-center justify-center cursor-pointer relative overflow-hidden ${isPressed ? 'active' : ''}`}
                    >
                      {isPressed && <div className="ripple-effect"></div>}
                      <div className="text-center">
                        <h2 className="text-6xl font-bold text-white">{state.count}</h2>
                      </div>
                    </div>
                    <button 
                      onClick={resetCounter}
                      className="absolute top-[280px] right-4 w-12 h-12 rounded-full bg-dark-100 border border-dark-200 shadow-md flex items-center justify-center cursor-pointer transition-transform hover:scale-110"
                    >
                      <span className="text-primary text-xl">â†º</span>
                    </button>
                    <button 
                      onClick={editCurrentZikrGoal}
                      className="absolute top-[280px] left-4 w-12 h-12 rounded-full bg-dark-100 border border-dark-200 shadow-md flex items-center justify-center cursor-pointer transition-transform hover:scale-110"
                    >
                      <span className="text-dark-500 text-xl">âœ</span>
                    </button>
                  </div>

                  <div className="mt-24 bg-dark-100 border border-dark-200 rounded-lg shadow-sm p-4 w-full">
                    <div className="flex justify-between items-center">
                      <span className="text-white">Ø§Ù„Ù‡Ø¯Ù Ø§Ù„ÙŠÙˆÙ…ÙŠ</span>
                      <span className="text-white font-medium">
                        {state.dailyCount} / {state.stats.goals.daily}
                      </span>
                    </div>
                    <div className="w-full bg-dark-200 rounded-full h-2 mt-2">
                      <div 
                        className="bg-primary h-2 rounded-full" 
                        style={{ width: `${dailyProgress}%` }}
                      ></div>
                    </div>
                  </div>
                </div>
              </div>
            )}

            {activeTab === 'azkar' && (
              <div className="px-4 py-6">
                <div className="mt-2 space-y-4">
                  <div className="relative mb-6">
                    <input 
                      type="text" 
                      value={searchTerm}
                      onChange={(e) => setSearchTerm(e.target.value)}
                      placeholder="Ø§Ø¨Ø­Ø« Ø¹Ù† Ø°ÙƒØ±..." 
                      className="w-full py-3 px-4 bg-dark-100 border border-dark-200 rounded-lg shadow-sm pl-10 text-white placeholder-dark-500"
                    />
                    <div className="absolute left-3 top-3 w-6 h-6 flex items-center justify-center">
                      <span className="text-dark-500">ğŸ”</span>
                    </div>
                  </div>

                  <div className="space-y-4">
                    {filteredAzkar.map(zikr => (
                      <div 
                        key={zikr.id}
                        onClick={() => switchToZikr(zikr.text)} 
                        className="bg-dark-100 border border-dark-200 rounded-lg shadow-sm p-4 cursor-pointer"
                      >
                        <div className="flex justify-between">
                          <h3 className="text-white font-medium">{zikr.text}</h3>
                          <div className="flex space-x-2 space-x-reverse">
                            <button 
                              onClick={(e) => editZikr(zikr.id, e)}
                              className="w-8 h-8 flex items-center justify-center text-dark-500 bg-dark-200 rounded-full cursor-pointer"
                            >
                              <span>âœ</span>
                            </button>
                            <button 
                              onClick={(e) => deleteZikr(zikr.id, e)}
                              className="w-8 h-8 flex items-center justify-center text-dark-500 bg-dark-200 rounded-full cursor-pointer"
                            >
                              <span>ğŸ—‘ï¸</span>
                            </button>
                          </div>
                        </div>
                        <div className="mt-2 flex justify-between text-sm">
                          <span className="text-dark-500">Ø§Ù„Ø¹Ø¯Ø¯ Ø§Ù„ÙŠÙˆÙ…ÙŠ: {zikr.dailyCount}</span>
                        </div>
                        <div className="mt-1 flex justify-between text-sm">
                          <span className="text-dark-500">Ø§Ù„Ø¹Ø¯Ø¯ Ø§Ù„ÙƒÙ„ÙŠ: {zikr.totalCount}</span>
                        </div>
                      </div>
                    ))}
                  </div>

                  <div className="fixed bottom-20 left-4 z-10">
                    <button 
                      onClick={addZikr}
                      className="w-14 h-14 bg-primary rounded-full shadow-lg flex items-center justify-center text-white cursor-pointer"
                    >
                      <span className="text-2xl">+</span>
                    </button>
                  </div>
                </div>
              </div>
            )}

            {activeTab === 'stats' && (
              <div className="px-4 py-6">
                <div className="mt-4">
                  <div className="text-center mb-6">
                    <h2 className="text-lg font-medium text-white">{formatDate()}</h2>
                  </div>

                  <div className="space-y-4">
                    <div className="bg-dark-100 border border-dark-200 rounded-lg shadow-sm p-5">
                      <div className="flex items-center">
                        <div className="w-12 h-12 bg-primary/10 rounded-full flex items-center justify-center ml-4">
                          <span className="text-primary text-xl">ğŸ“…</span>
                        </div>
                        <div>
                          <h3 className="text-dark-500 text-sm">Ø§Ù„ØªØ³Ø¨ÙŠØ­Ø§Øª Ø§Ù„ÙŠÙˆÙ…ÙŠØ©</h3>
                          <p className="text-3xl font-bold text-white mt-1">{state.stats.daily}</p>
                        </div>
                        <div className="mr-auto">
                          <button 
                            onClick={(e) => editGoal('daily', e)}
                            className="w-8 h-8 flex items-center justify-center text-dark-500 bg-dark-200 rounded-full"
                          >
                            <span>âœ</span>
                          </button>
                        </div>
                      </div>
                      <div className="mt-4">
                        <div className="flex justify-between text-sm mb-1">
                          <span className="text-dark-500">Ø§Ù„Ù‡Ø¯Ù Ø§Ù„ÙŠÙˆÙ…ÙŠ</span>
                          <span className="text-primary">
                            {state.stats.daily} / {state.stats.goals.daily}
                          </span>
                        </div>
                        <div className="w-full bg-dark-200 rounded-full h-2">
                          <div 
                            className="bg-primary h-2 rounded-full" 
                            style={{ width: `${statsDaily}%` }}
                          ></div>
                        </div>
                      </div>
                    </div>

                    <div className="bg-dark-100 border border-dark-200 rounded-lg shadow-sm p-5">
                      <div className="flex items-center">
                        <div className="w-12 h-12 bg-primary/10 rounded-full flex items-center justify-center ml-4">
                          <span className="text-primary text-xl">ğŸ“…</span>
                        </div>
                        <div>
                          <h3 className="text-dark-500 text-sm">Ø§Ù„ØªØ³Ø¨ÙŠØ­Ø§Øª Ø§Ù„Ø´Ù‡Ø±ÙŠØ©</h3>
                          <p className="text-3xl font-bold text-white mt-1">{state.stats.monthly}</p>
                        </div>
                        <div className="mr-auto">
                          <button 
                            onClick={(e) => editGoal('monthly', e)}
                            className="w-8 h-8 flex items-center justify-center text-dark-500 bg-dark-200 rounded-full"
                          >
                            <span>âœ</span>
                          </button>
                        </div>
                      </div>
                      <div className="mt-4">
                        <div className="flex justify-between text-sm mb-1">
                          <span className="text-dark-500">Ø§Ù„Ù‡Ø¯Ù Ø§Ù„Ø´Ù‡Ø±ÙŠ</span>
                          <span className="text-primary">
                            {state.stats.monthly} / {state.stats.goals.monthly}
                          </span>
                        </div>
                        <div className="w-full bg-dark-200 rounded-full h-2">
                          <div 
                            className="bg-primary h-2 rounded-full" 
                            style={{ width: `${statsMonthly}%` }}
                          ></div>
                        </div>
                      </div>
                    </div>

                    <div className="bg-dark-100 border border-dark-200 rounded-lg shadow-sm p-5">
                      <div className="flex items-center">
                        <div className="w-12 h-12 bg-primary/10 rounded-full flex items-center justify-center ml-4">
                          <span className="text-primary text-xl">ğŸ†</span>
                        </div>
                        <div>
                          <h3 className="text-dark-500 text-sm">Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„ÙƒÙ„ÙŠ</h3>
                          <p className="text-3xl font-bold text-white mt-1">{state.stats.total}</p>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            )}

            {activeTab === 'settings' && (
              <div className="px-4 py-6">
                <div className="mt-4 space-y-4">
                  <div className="bg-dark-100 border border-dark-200 rounded-lg shadow-sm p-4">
                    <div className="flex items-center justify-between">
                      <div className="flex items-center">
                        <div className="w-10 h-10 bg-primary/10 rounded-full flex items-center justify-center ml-3">
                          <span className="text-primary">ğŸ”Š</span>
                        </div>
                        <span className="text-white">Ø§Ù„ØµÙˆØª</span>
                      </div>
                      <label className="relative inline-flex items-center cursor-pointer">
                        <input 
                          type="checkbox" 
                          className="sr-only peer"
                          checked={state.settings.sound}
                          onChange={(e) => updateSetting('sound', e.target.checked)}
                        />
                        <div className="w-11 h-6 bg-dark-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-primary/20 rounded-full peer peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:start-[2px] after:bg-white after:border-dark-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-primary"></div>
                      </label>
                    </div>
                  </div>

                  <div className="bg-dark-100 border border-dark-200 rounded-lg shadow-sm p-4">
                    <div className="flex items-center justify-between">
                      <div className="flex items-center">
                        <div className="w-10 h-10 bg-primary/10 rounded-full flex items-center justify-center ml-3">
                          <span className="text-primary">ğŸ“³</span>
                        </div>
                        <span className="text-white">Ø§Ù„Ø§Ù‡ØªØ²Ø§Ø²</span>
                      </div>
                      <label className="relative inline-flex items-center cursor-pointer">
                        <input 
                          type="checkbox" 
                          className="sr-only peer"
                          checked={state.settings.vibration}
                          onChange={(e) => updateSetting('vibration', e.target.checked)}
                        />
                        <div className="w-11 h-6 bg-dark-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-primary/20 rounded-full peer peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:start-[2px] after:bg-white after:border-dark-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-primary"></div>
                      </label>
                    </div>
                  </div>

                  <div className="bg-dark-100 border border-dark-200 rounded-lg shadow-sm p-4">
                    <div className="flex items-center">
                      <div className="w-10 h-10 bg-primary/10 rounded-full flex items-center justify-center ml-3">
                        <span className="text-primary">â„¹ï¸</span>
                      </div>
                      <button onClick={showAbout} className="text-white">Ø¹Ù† Ø§Ù„ØªØ·Ø¨ÙŠÙ‚</button>
                    </div>
                  </div>
                </div>
              </div>
            )}
          </div>

          <div className="fixed bottom-0 w-full bg-dark-100 border-t border-dark-200 shadow-sm z-10 max-w-md">
            <div className="grid grid-cols-4 h-16">
              <button 
                onClick={() => setActiveTab('tasbih')}
                className={`flex flex-col items-center justify-center cursor-pointer ${activeTab === 'tasbih' ? 'text-primary' : 'text-dark-500'}`}
              >
                <div className="w-6 h-6 flex items-center justify-center">
                  <span className="text-xl">ğŸ“¿</span>
                </div>
                <span className="text-xs mt-1">Ø§Ù„ØªØ³Ø¨ÙŠØ­</span>
              </button>
              <button 
                onClick={() => setActiveTab('azkar')}
                className={`flex flex-col items-center justify-center cursor-pointer ${activeTab === 'azkar' ? 'text-primary' : 'text-dark-500'}`}
              >
                <div className="w-6 h-6 flex items-center justify-center">
                  <span className="text-xl">ğŸ“–</span>
                </div>
                <span className="text-xs mt-1">Ø§Ù„Ø£Ø°ÙƒØ§Ø±</span>
              </button>
              <button 
                onClick={() => setActiveTab('stats')}
                className={`flex flex-col items-center justify-center cursor-pointer ${activeTab === 'stats' ? 'text-primary' : 'text-dark-500'}`}
              >
                <div className="w-6 h-6 flex items-center justify-center">
                  <span className="text-xl">ğŸ“Š</span>
                </div>
                <span className="text-xs mt-1">Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª</span>
              </button>
              <button 
                onClick={() => setActiveTab('settings')}
                className={`flex flex-col items-center justify-center cursor-pointer ${activeTab === 'settings' ? 'text-primary' : 'text-dark-500'}`}
              >
                <div className="w-6 h-6 flex items-center justify-center">
                  <span className="text-xl">âš™ï¸</span>
                </div>
                <span className="text-xs mt-1">Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª</span>
              </button>
            </div>
          </div>
        </div>
      );
    }

    try {
      console.log('Main: Attempting to render React app');
      const root = ReactDOM.createRoot(document.getElementById('root'));
      root.render(<App />);
      console.log('Main: React app rendered successfully');
    } catch (error) {
      console.error('Main: Error rendering React app:', error);
    }
  </script>
  <script src="https://unpkg.com/@babel/standalone@7.22.5/babel.min.js" onerror='console.error("Failed to load Babel")'></script>
</body>
</html>